<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://metrics.couchbase.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
<!-- End Google Tag Manager -->
<title>cbbackupmgr generate | Couchbase Docs</title>
<link rel="canonical" href="https://docs.couchbase.com/server/current/backup-restore/cbbackupmgr-generate.html">
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Generate documents and send them to a &#x27;sink&#x27;, primarily for testing purposes.">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="7.6">
<meta name="page-url" content="/server/current/backup-restore/cbbackupmgr-generate.html">
<meta name="page-nav-header-levels" content="0">

<meta name="docsearch:component" content="server">
<meta name="docsearch:component_title" content="Couchbase Server">
<meta name="docsearch:cversion" content="7.6">
<meta name="docsearch:component_version" content="server@7.6">
<meta name="docsearch:module" content="backup-restore">
<meta name="docsearch:breadcrumbs" content="Couchbase Server / cbbackupmgr generate">
<meta name="docsearch:topic_type" content="">
<meta name="docsearch:version_rank" content="1">
<meta name="docsearch:status" content="">
<meta name="docsearch:edition" content="">
<meta name="docsearch:page_rank" content="50">


<meta name="generator" content="Antora 3.1.7">
<link rel="icon" href="../../../_/img/favicon.svg" type="image/svg+xml">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation"
                      href="https://docs.couchbase.com/home/index.html">
                    <img src="../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">

                  <li class="nav-item "">
                    <a href="https://docs.couchbase.com/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item nav-item-selected">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                      
                    </a>
                  </li>
                  <li class="nav-item ">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                      
                    </a>
                  </li>
                  <li class="nav-item ">
                    <a class="nav-link" href="../../../cloud/index.html">
                      Capella
                      
                    </a>
                  </li>
                  <li class="nav-item ">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                      
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>
              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
    <template id="page-versions" style="display: none">
      <select class="version_list" data-component="server">
        <option value="7.6" data-url="cbbackupmgr-generate.html" selected>7.6</option>
        <option value="7.2" data-url="../../7.2/index.html">7.2</option>
        <option value="7.1" data-url="../../7.1/index.html">7.1</option>
        <option value="7.0" data-url="../../7.0/index.html">7.0</option>
      </select>
    </template>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/rayoffiah/projects/couchbase/backup/docs/modules/backup-restore/pages/cbbackupmgr-generate.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../introduction/intro.html">Couchbase Server</a></li>
<li class="crumb"><a href="cbbackupmgr-generate.html">cbbackupmgr generate</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">cbbackupmgr generate</h1>
<div class="labels">
<ul></ul>
</div>


</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Generate documents and send them to a 'sink', primarily for testing purposes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synopsis"><a class="anchor" href="#synopsis"></a>SYNOPSIS</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content">cbbackupmgr generate [--num-documents &lt;document_count&gt;] [--archive &lt;archive_dir&gt;]
                     [--cluster &lt;cluster_hostname&gt;] [--username &lt;username&gt;]
                     [--password &lt;password&gt;] [--client-cert &lt;path&gt;]
                     [--client-cert-password &lt;password&gt;] [--client-key &lt;path&gt;]
                     [--client-key-password &lt;password&gt;] [--bucket &lt;bucket_name&gt;]
                     [--cacert &lt;certfile_path&gt;] [--no-ssl-verify] [--repo &lt;repository_name&gt;]
                     [--sink &lt;sink_name&gt;] [--prefix &lt;prefix&gt;] [--size &lt;size&gt;] [--json]
                     [--json-fields &lt;field_count&gt;] [--json-field-size &lt;field_size&gt;]
                     [--low-compression] [--xattrs] [--xattr-fields &lt;field_count&gt;]
                     [--xattr-field-size &lt;field_size&gt;] [--compress]
                     [--threads &lt;thread_count&gt;] [--purge] [--resume]
                     [--storage &lt;storage_type&gt;] [--no-progress-bar]</pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="description"><a class="anchor" href="#description"></a>DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The generate command is primarily meant for testing the internal pipeline for
backup/restore. It allows you to very quickly generate documents and send them
to a desired 'sink'.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="required"><a class="anchor" href="#required"></a>Required</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">-n,--num-documents &lt;document_count&gt;</dt>
<dd>
<p>The number of documents to generate.</p>
</dd>
<dt class="hdlist1">-b,--bucket &lt;bucket_name&gt;</dt>
<dd>
<p>The bucket to generate documents for.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="optional"><a class="anchor" href="#optional"></a>Optional</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">-a,--archive &lt;archive_dir&gt;</dt>
<dd>
<p>The archive in which to store generated documents (optionally used for logging when 'sink' is Couchbase).</p>
</dd>
<dt class="hdlist1">-c,--cluster &lt;cluster_hostname&gt;</dt>
<dd>
<p>The hostname of the test cluster (only required when 'sink' is couchbase).</p>
</dd>
<dt class="hdlist1">-u,--username &lt;username&gt;</dt>
<dd>
<p>The username for cluster authentication. The user must have the appropriate
privileges to take a backup.</p>
</dd>
<dt class="hdlist1">-p,--password &lt;password&gt;</dt>
<dd>
<p>The password for cluster authentication. The user must have the appropriate
privileges to take a backup. If not password is supplied to this option then
you will be prompted to enter your password.</p>
</dd>
<dt class="hdlist1">--client-cert &lt;path&gt;</dt>
<dd>
<p>The path to a client certificate used to authenticate when connecting to a
cluster. May be supplied with <code>--client-key</code> as an alternative to the
<code>--username</code> and <code>--password</code> flags.  See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a>
section for more information.</p>
</dd>
<dt class="hdlist1">--client-cert-password &lt;password&gt;</dt>
<dd>
<p>The password for the certificate provided to the <code>--client-cert</code> flag, when
using this flag, the certificate/key pair is expected to be in the PKCS#12
format. See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a> section for more information.</p>
</dd>
<dt class="hdlist1">--client-key &lt;path&gt;</dt>
<dd>
<p>The path to the client private key whose public key is contained in the
certificate provided to the <code>--client-cert</code> flag. May be supplied with
<code>--client-cert</code> as an alternative to the <code>--username</code> and <code>--password</code>
flags. See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a> section for more information.</p>
</dd>
<dt class="hdlist1">--client-key-password &lt;password&gt;</dt>
<dd>
<p>The password for the key provided to the <code>--client-key</code> flag, when using this
flag, the key is expected to be in the PKCS#8 format.
See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a> section for more information.</p>
</dd>
<dt class="hdlist1">--no-ssl-verify</dt>
<dd>
<p>Skips the SSL verification phase.
Specifying this flag will allow a connection using SSL encryption, but will not verify the identity of the server you connect to.
You are vulnerable to a man-in-the-middle attack if you use this flag.
Either this flag or the --cacert flag must be specified when using an SSL encrypted connection.</p>
</dd>
<dt class="hdlist1">--cacert &lt;cert_path&gt;</dt>
<dd>
<p>Specifies a CA certificate that will be used to verify the identity of the server being connecting to.
Either this flag or the --no-ssl-verify flag must be specified when using an SSL encrypted connection.</p>
</dd>
<dt class="hdlist1">-r,--repo &lt;repo&gt;</dt>
<dd>
<p>The name of a backup repository in an archive (only required when 'sink' is archive).</p>
</dd>
<dt class="hdlist1">-s,--sink &lt;sink&gt;</dt>
<dd>
<p>The sink to send generated documents to (valid options are 'archive', 'blackhole' and 'couchbase')</p>
</dd>
<dt class="hdlist1">-P,--prefix &lt;prefix&gt;</dt>
<dd>
<p>An optional prefix that will be prepended to generated keys.</p>
</dd>
<dt class="hdlist1">-s,--size &lt;size&gt;</dt>
<dd>
<p>The size of generated binary documents in bytes.</p>
</dd>
<dt class="hdlist1">-j,--json</dt>
<dd>
<p>Generated JSON formatted documents instead of binary documents.</p>
</dd>
<dt class="hdlist1">--json-fields &lt;num_fields&gt;</dt>
<dd>
<p>The number of JSON fields to generate.</p>
</dd>
<dt class="hdlist1">--json-value-size &lt;value_size&gt;</dt>
<dd>
<p>The size in bytes of the generated JSON values.</p>
</dd>
<dt class="hdlist1">--low-compression</dt>
<dd>
<p>Generate document values/xattr value which are difficult to compress.</p>
</dd>
<dt class="hdlist1">--xattrs</dt>
<dd>
<p>Generate extended attributes.</p>
</dd>
<dt class="hdlist1">--xattr-fields &lt;num_fields&gt;</dt>
<dd>
<p>The number of fields to generate in the xattrs.</p>
</dd>
<dt class="hdlist1">--xattr-value-size &lt;value_size&gt;</dt>
<dd>
<p>The size in bytes of the generated xattr values (hard coded limit of 2 bytes).</p>
</dd>
<dt class="hdlist1">--compress</dt>
<dd>
<p>Force compression at the "gocbcore" level (default is uncompressed).</p>
</dd>
<dt class="hdlist1">-t,--threads &lt;thread_count&gt;</dt>
<dd>
<p>The amount of worker threads to created for document generation.</p>
</dd>
<dt class="hdlist1">--resume</dt>
<dd>
<p>If you previously canceled a backup/generate test there will be a backup
directory remaining; continue generating to the same backup.</p>
</dd>
<dt class="hdlist1">--purge</dt>
<dd>
<p>If you previously canceled a backup/generate test there will be a backup
directory remaining; remove it before continuing.</p>
</dd>
<dt class="hdlist1">--shard-count &lt;shard_count&gt;</dt>
<dd>
<p>The number of shards to create when generating to an archive. This option is
silently ignored when generating to the 'couchbase' or 'blackhole' sinks.</p>
</dd>
<dt class="hdlist1">--no-progress-bar</dt>
<dd>
<p>By default, a progress bar is printed to stdout so that the user can see how
long the generation is expected to take, the amount of data that is being
transferred per second, and the amount of data that has been generated.
Specifying this flag disables the progress bar and is useful when running
automated jobs.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="HOST_FORMATS"><a class="anchor" href="#HOST_FORMATS"></a>HOST FORMATS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When specifying a host/cluster for a command using the <code>-c</code>/<code>--cluster</code> flag, the following formats
are accepted:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>http://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>https://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>couchbase://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>couchbases://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>couchbase://&lt;srv&gt;</code></p>
</li>
<li>
<p><code>couchbases://&lt;srv&gt;</code></p>
</li>
<li>
<p><code>&lt;addr&gt;:&lt;port&gt;,&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>&lt;scheme&gt;://&lt;addr&gt;:&lt;port&gt;,&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>&lt;port&gt;</code> portion of the host format may be omitted, in which case the default port will be used
for the scheme provided. For example, <code>http://</code> and <code>couchbase://</code> will both default to 8091 where
<code>https://</code> and <code>couchbases://</code> will default to 18091. When connecting to a host/cluster using a
non-default port, the <code>&lt;port&gt;</code> portion of the host format must be specified.</p>
</div>
<div class="sect2">
<h3 id="connection-strings-multiple-nodes"><a class="anchor" href="#connection-strings-multiple-nodes"></a>Connection Strings (Multiple nodes)</h3>
<div class="paragraph">
<p>The <code>-c</code>/<code>--cluster</code> flag accepts multiple nodes in the format of a connection string; this is a
comma separated list of <code>&lt;addr&gt;:&lt;port&gt;</code> strings where <code>&lt;scheme&gt;</code> only needs to be specified once.
The main advantage of supplying multiple hosts is that in the event of a failure, the next host in
the list will be used.</p>
</div>
<div class="paragraph">
<p>For example, all of the following are valid connection strings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>localhost,[::1]</code></p>
</li>
<li>
<p><code>10.0.0.1,10.0.0.2</code></p>
</li>
<li>
<p><code>http://10.0.0.1,10.0.0.2</code></p>
</li>
<li>
<p><code>https://10.0.0.1:12345,10.0.0.2</code></p>
</li>
<li>
<p><code>couchbase://10.0.0.1,10.0.0.2</code></p>
</li>
<li>
<p><code>couchbases://10.0.0.1:12345,10.0.0.2:12345</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="srv-records"><a class="anchor" href="#srv-records"></a>SRV Records</h3>
<div class="paragraph">
<p>The <code>-c</code>/<code>--cluster</code> flag accepts DNS SRV records in place of a host/cluster address where the SRV
record will be resolved into a valid connection string. There are a couple of rules which must be
followed when supplying an SRV record which are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>&lt;scheme&gt;</code> portion must be either <code>couchbase://</code> or <code>couchbases://</code></p>
</li>
<li>
<p>The <code>&lt;srv&gt;</code> portion should be a hostname with no port</p>
</li>
<li>
<p>The <code>&lt;srv&gt;</code> portion must not be a valid IP address</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, all of the following are valid connection string using an SRV record:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>couchbase://hostname</code></p>
</li>
<li>
<p><code>couchbases://hostname</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="alternate-addressing-caok8s"><a class="anchor" href="#alternate-addressing-caok8s"></a>Alternate Addressing (CAO/K8S)</h3>
<div class="paragraph">
<p>Users of the CAO (Couchbase Autonomous Operator) or K8S may need to supply the
<code>network=external</code> query parameter to force connection via the defined
alternate addressing.</p>
</div>
<div class="paragraph">
<p>For example, the following are valid connection strings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>https://10.0.0.1:12345,10.0.0.2?network=default</code></p>
</li>
<li>
<p><code>https://10.0.0.1:12345,10.0.0.2?network=external</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="CERTIFICATE_AUTHENTICATION"><a class="anchor" href="#CERTIFICATE_AUTHENTICATION"></a>CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tool supports authenticating against a Couchbase Cluster by using certificate based authentication (mTLS
authentication). To use certificate based authentication a certificate/key must be supplied, there a currently
multiple ways this may be done.</p>
</div>
<div class="sect2">
<h3 id="pem-encoded-certificatekey"><a class="anchor" href="#pem-encoded-certificatekey"></a>PEM ENCODED CERTIFICATE/KEY</h3>
<div class="paragraph">
<p>An unencrypted PEM encoded certificate/key may be supplied by using:
- <code>--client-cert &lt;path&gt;</code>
- <code>--client-key &lt;path&gt;</code></p>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-cert</code> must contain the client certificate, and an optional chain required to authenticate
the client certificate.</p>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-key</code> must contain at most one private key, the key can be in one of the following formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PKCS#1</p>
</li>
<li>
<p>PKCS#8</p>
</li>
<li>
<p>EC</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Currently, only the following key types are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSA</p>
</li>
<li>
<p>ECDSA</p>
</li>
<li>
<p>ED25519</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="pem-encoded-certificatepem-or-der-encrypted-pkcs8-key"><a class="anchor" href="#pem-encoded-certificatepem-or-der-encrypted-pkcs8-key"></a>PEM ENCODED CERTIFICATE/PEM OR DER ENCRYPTED PKCS#8 KEY</h3>
<div class="paragraph">
<p>An encrypted PKCS#8 formatted key may be provided using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--client-cert &lt;path&gt;</code></p>
</li>
<li>
<p><code>--client-key &lt;path&gt;</code></p>
</li>
<li>
<p><code>--client-key-password &lt;password&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-cert</code> must contain the client certificate, and an optional chain required to authenticate
the client certificate.</p>
</div>
<div class="paragraph">
<p>Currently, only the following key types are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSA</p>
</li>
<li>
<p>ECDSA</p>
</li>
<li>
<p>ED25519</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="encrypted-pkcs12-certificatekey"><a class="anchor" href="#encrypted-pkcs12-certificatekey"></a>ENCRYPTED PKCS#12 CERTIFICATE/KEY</h3>
<div class="paragraph">
<p>An encrypted PKCS#12 certificate/key may be provided using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--client-cert &lt;path&gt;</code></p>
</li>
<li>
<p><code>--client-cert-password &lt;password&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-cert</code> must contain the client certificate and exactly one private key. It may also contain
the chain required to authenticate the client certificate.</p>
</div>
<div class="paragraph">
<p>Currently, only the following key types are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSA</p>
</li>
<li>
<p>ECDSA</p>
</li>
<li>
<p>ED25519</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rbac"><a class="anchor" href="#rbac"></a>RBAC</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When performing a backup/restore with a user which is using RBAC, there are a
couple of things that should be taken into consideration each of which is
highlighted in this section.</p>
</div>
<div class="sect2">
<h3 id="bucket-level"><a class="anchor" href="#bucket-level"></a>Bucket Level</h3>
<div class="paragraph">
<p>Bucket level data may be backed up/restored using the <code>data_backup</code> (Data
Backup &amp; Restore) role.</p>
</div>
<div class="paragraph">
<p>The <code>data_backup</code> role does not have access to cluster level data such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Analytics Synonyms</p>
</li>
<li>
<p>Eventing Metadata</p>
</li>
<li>
<p>FTS Aliases</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Backing up/restoring cluster level data with the <code>data_backup</code> role will cause
permission errors like the one below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Error backing up cluster: {"message":"Forbidden. User needs one of the following permissions","permissions":["cluster.fts!read"]}</pre>
</div>
</div>
<div class="paragraph">
<p>When presented with an error message such as the one above, there&#8217;s two clear
options.</p>
</div>
<div class="paragraph">
<p>The first option is to provide the user with the required credentials using
either the cli, REST API or Couchbase Server WebUI. This can be done by editing
the user and adding the required role. See <code>Cluster Level</code> for more information
about the required roles.</p>
</div>
<div class="paragraph">
<p>Secondly, backing up/restoring the specific service can be disabled. For
backups this must be done when configuring the repository with the <code>config</code>
command using the <code>--disable</code> style flags. For restore, these flags may be used
directly to disable one or more services. See the backup/restore documentation
for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="cluster-level"><a class="anchor" href="#cluster-level"></a>Cluster Level</h3>
<div class="paragraph">
<p>Backing up/restoring cluster level data requires additional RBAC roles, each of
which is highlighted below:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Analytics Synonyms</dt>
<dd>
<p><code>analytics_admin</code> (Analytics Admin)</p>
</dd>
<dt class="hdlist1">Eventing Metadata</dt>
<dd>
<p><code>eventing_admin</code> (Eventing Full Admin)</p>
</dd>
<dt class="hdlist1">FTS Aliases</dt>
<dd>
<p><code>fts_admin</code> (Search Admin)</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These additional roles are required since this is cluster level data which may
encompass multiple buckets.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples"><a class="anchor" href="#examples"></a>EXAMPLES</h2>
<div class="sectionbody">
<div class="paragraph">
<p>cbbackupmgr generate is used to generate documents and send them through the
cbbackupmgr pipeline; this command is primarily intended for testing.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbbackupmgr generate -a /data/backups -c localhost -u admin -p password -n 1000 -s 1024
1000/1000 - 100% - 999D/s - 1.03MB/s
Transfer completed in 1.000174463s</pre>
</div>
</div>
<div class="paragraph">
<p>By supplying the optional 'sink' argument you can choose which sink to send the
generate documents to; to test the speed to the document generate itself, specify
the sink as 'blackhole'.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbbackupmgr generate -a /data/backups -n 100000 -s 1048576 --sink 'blackhole'
100000/100000 - 100% - 9084D/s - 8.87GB/s
Transfer completed in 11.007203014s</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cbbackupmgr"><a class="anchor" href="#cbbackupmgr"></a>CBBACKUPMGR</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the <a href="cbbackupmgr.html" class="xref page">cbbackupmgr</a> suite</p>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2024 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Server","components":["server"],"url":"/home/server.html","latestVersions":{"server":"7.6"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../_/js/vendor/chatbox-ui.js"></script>
<script id="site-script" src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab"></script>
<script defer src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
