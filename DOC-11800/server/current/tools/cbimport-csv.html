<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://metrics.couchbase.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
<!-- End Google Tag Manager -->
<title>cbimport csv | Couchbase Docs</title>
<link rel="canonical" href="https://docs.couchbase.com/server/current/tools/cbimport-csv.html">
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Imports CSV data into Couchbase">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="server">
<meta name="dcterms.identifier" content="7.6">
<meta name="page-url" content="/server/current/tools/cbimport-csv.html">
<meta name="page-nav-header-levels" content="0">
<meta name="generator" content="Antora 3.1.7">
<link rel="icon" href="../../../_/img/favicon.svg" type="image/svg+xml">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.couchbase.com/home/index.html">
                    <img src="../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://docs.couchbase.com/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
    <template id="page-versions" style="display: none">
      <select class="version_list" data-component="server">
        <option value="7.6" data-url="cbimport-csv.html" selected>7.6</option>
        <option value="7.2" data-url="../../7.2/introduction/intro.html">7.2</option>
        <option value="7.1" data-url="../../7.1/index.html">7.1</option>
        <option value="7.0" data-url="../../7.0/index.html">7.0</option>
        <option value="6.6" data-url="../../6.6/index.html">6.6</option>
        <option value="6.5" data-url="../../6.5/index.html">6.5</option>
        <option value="6.0" data-url="../../6.0/index.html">6.0</option>
      </select>
    </template>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/rayoffiah/projects/couchbase/backup/docs/modules/tools/pages/cbimport-csv.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../index.html">server</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">cbimport csv</h1>
<div class="labels">
<ul></ul>
</div>


</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Imports CSV data into Couchbase</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="synopsis"><a class="anchor" href="#synopsis"></a>SYNOPSIS</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content">cbimport csv [--cluster &lt;url&gt;] [--bucket &lt;bucket_name&gt;] [--dataset &lt;path&gt;]
             [--username &lt;username&gt;] [--password &lt;password&gt;] [--client-cert &lt;path&gt;]
             [--client-cert-password &lt;password&gt;] [--client-key &lt;path&gt;]
             [--client-key-password &lt;password&gt;] [--generate-key &lt;key_expr&gt;]
             [--limit-rows &lt;num&gt;] [--skip-rows &lt;num&gt;] [--field-separator &lt;char&gt;]
             [--cacert &lt;path&gt;] [--no-ssl-verify] [--threads &lt;num&gt;]
             [--error-log &lt;path&gt;] [--log-file &lt;path&gt;] [--verbose]
             [--field-delimiter &lt;char&gt;] [--generator-delimiter &lt;char&gt;]
             [--ignore-fields &lt;fields&gt;]
             [--scope-collection-exp &lt;scope_collection_expression&gt;]</pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="description"><a class="anchor" href="#description"></a>DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Imports CSV and other forms of separated value type data into Couchbase. By
default data files should contain comma separated values, but if for example you
are importing data that is tab separated you can use the --field-separator flag
to specify that tabs are used instead of commas.</p>
</div>
<div class="paragraph">
<p>The cbimport command also supports custom key-generation for each document in
the imported file. Key generation is done with a combination of pre-existing
fields in a document and custom generator functions supplied by cbimport. See
the <a href="#KEY_GENERATORS">KEY GENERATORS</a> section below for details about key generators.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="options"><a class="anchor" href="#options"></a>OPTIONS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Below are a list of required and optional parameters for the cbimport-csv
command.</p>
</div>
<div class="sect2">
<h3 id="required"><a class="anchor" href="#required"></a>Required</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">-c,--cluster &lt;url&gt;</dt>
<dd>
<p>The hostname of a node in the cluster to import data into. See the HOST
FORMATS section below for details about hostname specification formats.</p>
</dd>
<dt class="hdlist1">-u,--username &lt;username&gt;</dt>
<dd>
<p>The username for cluster authentication. The user must have the appropriate
privileges to take a backup.</p>
</dd>
<dt class="hdlist1">-p,--password &lt;password&gt;</dt>
<dd>
<p>The password for cluster authentication. The user must have the appropriate
privileges to take a backup. If not password is supplied to this option then
you will be prompted to enter your password.</p>
</dd>
<dt class="hdlist1">--client-cert &lt;path&gt;</dt>
<dd>
<p>The path to a client certificate used to authenticate when connecting to a
cluster. May be supplied with <code>--client-key</code> as an alternative to the
<code>--username</code> and <code>--password</code> flags.  See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a>
section for more information.</p>
</dd>
<dt class="hdlist1">--client-cert-password &lt;password&gt;</dt>
<dd>
<p>The password for the certificate provided to the <code>--client-cert</code> flag, when
using this flag, the certificate/key pair is expected to be in the PKCS#12
format. See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a> section for more information.</p>
</dd>
<dt class="hdlist1">--client-key &lt;path&gt;</dt>
<dd>
<p>The path to the client private key whose public key is contained in the
certificate provided to the <code>--client-cert</code> flag. May be supplied with
<code>--client-cert</code> as an alternative to the <code>--username</code> and <code>--password</code>
flags. See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a> section for more information.</p>
</dd>
<dt class="hdlist1">--client-key-password &lt;password&gt;</dt>
<dd>
<p>The password for the key provided to the <code>--client-key</code> flag, when using this
flag, the key is expected to be in the PKCS#8 format.
See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a> section for more information.</p>
</dd>
<dt class="hdlist1">-b,--bucket &lt;bucket_name&gt;</dt>
<dd>
<p>The name of the bucket to import data into.</p>
</dd>
<dt class="hdlist1">-d,--dataset &lt;uri&gt;</dt>
<dd>
<p>The URI of the dataset to be loaded. cbimport supports loading data from a
local file or from a URL. When importing data from a local file the path
must be prefixed with file://.</p>
</dd>
<dt class="hdlist1">-g,--generate-key &lt;key_expr&gt;</dt>
<dd>
<p>Specifies a key expression used for generating a key for each document
imported. See the Key Generation section below for more information on
specifying key generators. If the resulting key is not unique the values
will be overridden, resulting in fewer documents than expected being imported.
To ensure that the key is unique add #MONO_INCR# or #UUID# to the key
generator expression.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="optional"><a class="anchor" href="#optional"></a>Optional</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">--field-delimiter &lt;char&gt;</dt>
<dd>
<p>Specifies the character to be used to denote field references in the key
generator expression. It defaults to %. See the <a href="#KEY_GENERATORS">KEY GENERATORS</a> section.</p>
</dd>
<dt class="hdlist1">--generator-delimiter &lt;char&gt;</dt>
<dd>
<p>Specifies the character to be used to denote generator references in the key
generator expression. It defaults to #. See the <a href="#KEY_GENERATORS">KEY GENERATORS</a> section.</p>
</dd>
<dt class="hdlist1">--field-separator &lt;num&gt;</dt>
<dd>
<p>Specifies the field separator to use when reading the dataset. By default
the separator is a comma. To read tab separated files you can specify a tab
in this field. Tabs are specified as <em>\t</em>.</p>
</dd>
<dt class="hdlist1">--limit-rows &lt;num&gt;</dt>
<dd>
<p>Specifies that the utility should stop loading data after reading a certain
amount of rows from the dataset. This option is useful when you have a large
dataset and only want to partially load it.</p>
</dd>
<dt class="hdlist1">--skip-rows &lt;num&gt;</dt>
<dd>
<p>Specifies that the utility should skip some rows before we start importing
data. If this flag is used together with the --limit-rows flag then we will
import the number of rows specified by --limit-rows after we have skipped the
rows specified by --skip-rows.</p>
</dd>
<dt class="hdlist1">--no-ssl-verify</dt>
<dd>
<p>Skips the SSL verification phase. Specifying this flag will allow a
connection using SSL encryption, but will not verify the identity of the
server you connect to. You are vulnerable to a man-in-the-middle attack if
you use this flag. Either this flag or the --cacert flag must be specified
when using an SSL encrypted connection.</p>
</dd>
<dt class="hdlist1">--infer-types</dt>
<dd>
<p>By default all values in a CSV files are interpreted as strings. If infer
types is set then cbimport will look at each value and decide whether it is
a string, integer, or boolean value and put the inferred type into the
document.</p>
</dd>
<dt class="hdlist1">--omit-empty</dt>
<dd>
<p>Some values in a CSV row will not contain any data. By default these values
are put into the generated JSON document as an empty string. To omit fields
that contain empty values specify this flag.</p>
</dd>
<dt class="hdlist1">--cacert &lt;cert_path&gt;</dt>
<dd>
<p>Specifies a CA certificate that will be used to verify the identity of the
server being connecting to. Either this flag or the --no-ssl-verify flag
must be specified when using an SSL encrypted connection.</p>
</dd>
<dt class="hdlist1">--scope-collection-exp &lt;scope_collection_expression&gt;</dt>
<dd>
<p>When importing to a collection aware cluster you may optionally choose to
provide a scope/collection expression which will be used to determine which
scope/collection to insert the imported document in. This flag closely
resembles the behavior/syntax of the <code>--generate-key</code> flag. For example, to
use a static scope/collection use <code>--scope-collection-exp scope.collection</code>.
To use information from the CSV row, specify the column name between <code>%</code>
characters. For example,
<code>--scope-collection-exp %scope_column%.%collection_column%</code>. Columns that
contain a <code>%</code> character may be escaped using <code>%%</code>. For more information about
the accepted format, see the <a href="#SCOPE_COLLECTION_PARSER">SCOPE/COLLECTION PARSER</a> section.</p>
</dd>
<dt class="hdlist1">-t,--threads &lt;num&gt;</dt>
<dd>
<p>Specifies the number of concurrent clients to use when importing data. Fewer
clients means imports will take longer, but there will be less cluster
resources used to complete the import. More clients means faster imports,
but at the cost of more cluster resource usage. This parameter defaults to 1
if it is not specified and it is recommended that this parameter is not set
to be higher than the number of CPUs on the machine where the import is
taking place.</p>
</dd>
<dt class="hdlist1">-e,--errors-log &lt;path&gt;</dt>
<dd>
<p>Specifies a log file where JSON documents that could not be loaded are
written to. A document might not be loaded if a key could not be generated
for the document or if the document is not valid JSON. The errors file is
written in the "json lines" format (one document per line).</p>
</dd>
<dt class="hdlist1">-l,--log-file &lt;path&gt;</dt>
<dd>
<p>Specifies a log file for writing debugging information about cbimport
execution.</p>
</dd>
<dt class="hdlist1">-v,--verbose</dt>
<dd>
<p>Specifies that logging should be sent to stdout. If this flag is specified
along with the -l/--log-file option then the verbose option is ignored.</p>
</dd>
<dt class="hdlist1">--ignore-fields &lt;fields&gt;</dt>
<dd>
<p>Specify a comma separated list of field names that will be excluded from
the imported document. The field reference syntax is the same as the one
used in KEY GENERATORS to refer to fields.</p>
</dd>
<dt class="hdlist1">--http-cache-directory &lt;path&gt;</dt>
<dd>
<p>The directory used to store files when the <code>--dataset</code> flag uses the
'http(s)://' scheme; this avoids re-downloading the files when running
multiple imports.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="HOST_FORMATS"><a class="anchor" href="#HOST_FORMATS"></a>HOST FORMATS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When specifying a host/cluster for a command using the <code>-c</code>/<code>--cluster</code> flag, the following formats
are accepted:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>http://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>https://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>couchbase://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>couchbases://&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>couchbase://&lt;srv&gt;</code></p>
</li>
<li>
<p><code>couchbases://&lt;srv&gt;</code></p>
</li>
<li>
<p><code>&lt;addr&gt;:&lt;port&gt;,&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
<li>
<p><code>&lt;scheme&gt;://&lt;addr&gt;:&lt;port&gt;,&lt;addr&gt;:&lt;port&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>&lt;port&gt;</code> portion of the host format may be omitted, in which case the default port will be used
for the scheme provided. For example, <code>http://</code> and <code>couchbase://</code> will both default to 8091 where
<code>https://</code> and <code>couchbases://</code> will default to 18091. When connecting to a host/cluster using a
non-default port, the <code>&lt;port&gt;</code> portion of the host format must be specified.</p>
</div>
<div class="sect2">
<h3 id="connection-strings-multiple-nodes"><a class="anchor" href="#connection-strings-multiple-nodes"></a>Connection Strings (Multiple nodes)</h3>
<div class="paragraph">
<p>The <code>-c</code>/<code>--cluster</code> flag accepts multiple nodes in the format of a connection string; this is a
comma separated list of <code>&lt;addr&gt;:&lt;port&gt;</code> strings where <code>&lt;scheme&gt;</code> only needs to be specified once.
The main advantage of supplying multiple hosts is that in the event of a failure, the next host in
the list will be used.</p>
</div>
<div class="paragraph">
<p>For example, all of the following are valid connection strings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>localhost,[::1]</code></p>
</li>
<li>
<p><code>10.0.0.1,10.0.0.2</code></p>
</li>
<li>
<p><code>http://10.0.0.1,10.0.0.2</code></p>
</li>
<li>
<p><code>https://10.0.0.1:12345,10.0.0.2</code></p>
</li>
<li>
<p><code>couchbase://10.0.0.1,10.0.0.2</code></p>
</li>
<li>
<p><code>couchbases://10.0.0.1:12345,10.0.0.2:12345</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="srv-records"><a class="anchor" href="#srv-records"></a>SRV Records</h3>
<div class="paragraph">
<p>The <code>-c</code>/<code>--cluster</code> flag accepts DNS SRV records in place of a host/cluster address where the SRV
record will be resolved into a valid connection string. There are a couple of rules which must be
followed when supplying an SRV record which are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>&lt;scheme&gt;</code> portion must be either <code>couchbase://</code> or <code>couchbases://</code></p>
</li>
<li>
<p>The <code>&lt;srv&gt;</code> portion should be a hostname with no port</p>
</li>
<li>
<p>The <code>&lt;srv&gt;</code> portion must not be a valid IP address</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, all of the following are valid connection string using an SRV record:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>couchbase://hostname</code></p>
</li>
<li>
<p><code>couchbases://hostname</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="alternate-addressing-caok8s"><a class="anchor" href="#alternate-addressing-caok8s"></a>Alternate Addressing (CAO/K8S)</h3>
<div class="paragraph">
<p>Users of the CAO (Couchbase Autonomous Operator) or K8S may need to supply the
<code>network=external</code> query parameter to force connection via the defined
alternate addressing.</p>
</div>
<div class="paragraph">
<p>For example, the following are valid connection strings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>https://10.0.0.1:12345,10.0.0.2?network=default</code></p>
</li>
<li>
<p><code>https://10.0.0.1:12345,10.0.0.2?network=external</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="CERTIFICATE_AUTHENTICATION"><a class="anchor" href="#CERTIFICATE_AUTHENTICATION"></a>CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tool supports authenticating against a Couchbase Cluster by using certificate based authentication (mTLS
authentication). To use certificate based authentication a certificate/key must be supplied, there a currently
multiple ways this may be done.</p>
</div>
<div class="sect2">
<h3 id="pem-encoded-certificatekey"><a class="anchor" href="#pem-encoded-certificatekey"></a>PEM ENCODED CERTIFICATE/KEY</h3>
<div class="paragraph">
<p>An unencrypted PEM encoded certificate/key may be supplied by using:
- <code>--client-cert &lt;path&gt;</code>
- <code>--client-key &lt;path&gt;</code></p>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-cert</code> must contain the client certificate, and an optional chain required to authenticate
the client certificate.</p>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-key</code> must contain at most one private key, the key can be in one of the following formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PKCS#1</p>
</li>
<li>
<p>PKCS#8</p>
</li>
<li>
<p>EC</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Currently, only the following key types are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSA</p>
</li>
<li>
<p>ECDSA</p>
</li>
<li>
<p>ED25519</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="pem-encoded-certificatepem-or-der-encrypted-pkcs8-key"><a class="anchor" href="#pem-encoded-certificatepem-or-der-encrypted-pkcs8-key"></a>PEM ENCODED CERTIFICATE/PEM OR DER ENCRYPTED PKCS#8 KEY</h3>
<div class="paragraph">
<p>An encrypted PKCS#8 formatted key may be provided using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--client-cert &lt;path&gt;</code></p>
</li>
<li>
<p><code>--client-key &lt;path&gt;</code></p>
</li>
<li>
<p><code>--client-key-password &lt;password&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-cert</code> must contain the client certificate, and an optional chain required to authenticate
the client certificate.</p>
</div>
<div class="paragraph">
<p>Currently, only the following key types are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSA</p>
</li>
<li>
<p>ECDSA</p>
</li>
<li>
<p>ED25519</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="encrypted-pkcs12-certificatekey"><a class="anchor" href="#encrypted-pkcs12-certificatekey"></a>ENCRYPTED PKCS#12 CERTIFICATE/KEY</h3>
<div class="paragraph">
<p>An encrypted PKCS#12 certificate/key may be provided using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--client-cert &lt;path&gt;</code></p>
</li>
<li>
<p><code>--client-cert-password &lt;password&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The file passed to <code>--client-cert</code> must contain the client certificate and exactly one private key. It may also contain
the chain required to authenticate the client certificate.</p>
</div>
<div class="paragraph">
<p>Currently, only the following key types are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSA</p>
</li>
<li>
<p>ECDSA</p>
</li>
<li>
<p>ED25519</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="KEY_GENERATORS"><a class="anchor" href="#KEY_GENERATORS"></a>KEY GENERATORS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Key generators are used in order to generate a key for each document loaded.
Keys can be generated by using a combination of characters, the values of a
given row in a document, and custom generators. Row substitutions are done by
wrapping the column name in "%" and custom generators are wrapped in "#". Below
is an example of a key generation expression.</p>
</div>
<div class="paragraph">
<p>Given the CSV dataset:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fname,age
alice,40
barry,36</pre>
</div>
</div>
<div class="paragraph">
<p>Key Generator Expression:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>--generate-key key::%fname%::#MONO_INCR#</pre>
</div>
</div>
<div class="paragraph">
<p>The following keys would be generated:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>key::alice::1
key::barry::2</pre>
</div>
</div>
<div class="paragraph">
<p>In the example above we generate a key using the value in each row of the
<code>fname</code> column and a custom generator. To specify that we want to substitute the
value in the <code>fname</code> column we put the name of the column <code>fname</code> between two
percent signs. This is an example of field substitution and it allows the
ability to build keys out of data that is already in the dataset.</p>
</div>
<div class="paragraph">
<p>This example also contains a generator function MONO_INCR which will increment
by 1 each time the key generator is called. Since this is the first time this
key generator was executed it returns 1. If we executed the key generator again
it would return 2 and so on. The starting value of the <code>MONO_INCR</code> generator is 1
by default, but it can be changed by specifying a number in brackets after the
<code>MONO_INCR</code> generator name. To start generating monotonically incrementing values
starting at 100 for example, the generator <code>MONO_INCR[100]</code> would be specified.
The cbimport command current contains a monotonic increment generator
(MONO_INCR) and a UUID generator (UUID).</p>
</div>
<div class="paragraph">
<p>Any text that isn&#8217;t wrapped in "%" or "#" is static text and will be in the
result of all generated keys. If a key needs to contain a "%" or "#" in static
text then they need to be escaped by providing a double "%" or "#"
(ex. "%%" or "##"). The delimiter characters can be changed to avoid having to
escape them by using the --field-delimiter and --generator-delimiter flags.</p>
</div>
<div class="paragraph">
<p>If a key cannot be generated because the field specified in the key generator is
not present in the document then the key will be skipped. To see a list of
document that were not imported due to failed key generation users can specify
the --errors-log &lt;path&gt; parameter to dump a list of all documents that could not
be imported to a file.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="SCOPE_COLLECTION_PARSER"><a class="anchor" href="#SCOPE_COLLECTION_PARSER"></a>SCOPE/COLLECTION PARSER</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Scope/collection parsers are used in order to determine which scope/collection
to insert documents into. There are currently two supported parsers text/field.</p>
</div>
<div class="paragraph">
<p>Given the CSV dataset:</p>
</div>
<div class="literalblock">
<div class="content">
<pre> product, stock, type, subtype
apple, 100, produce, fruit</pre>
</div>
</div>
<div class="paragraph">
<p>Scope/collection expression:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>--scope-collection-exp %type%.%subtype%</pre>
</div>
</div>
<div class="paragraph">
<p>The row would be inserted into the 'fruit' collection inside the 'produce'
scope.</p>
</div>
<div class="paragraph">
<p>Given the CSV dataset:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fname,age
alice,40
barry,36</pre>
</div>
</div>
<div class="paragraph">
<p>Scope/collection expression:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>--scope-collection-exp uk.manchester</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, no fields in the row will be used to determine the scope or
collection; all the rows would be inserted into the 'manchester' collection
inside the 'uk' scope.</p>
</div>
<div class="paragraph">
<p>There is nothing stopping the mixture of text/field expressions the following
are all valid expressions.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>uk.%city%
uk.%city%-5
%country%.%city%::%town%</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples"><a class="anchor" href="#examples"></a>EXAMPLES</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the examples below we will show examples for importing data from the files
below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./data/people.csv

  fname,age
  alice,40
  barry,36

./data/people.tsv

  fname  age
  alice  40
  barry  36</pre>
</div>
</div>
<div class="paragraph">
<p>To import data from /data/people.csv using a key containing the <code>fname</code> column
and utilizing 4 threads the following command can be run.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbimport csv -c couchbase://127.0.0.1 -u Administrator -p password \
 -b default -d file:///data/people.csv -g key::%fname% -t 4</pre>
</div>
</div>
<div class="paragraph">
<p>To import data from /data/people.tsv using a key containing the <code>fname</code> column
and the UUID generator the following command would be run.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbimport csv -c couchbase://127.0.0.1 -u Administrator -p password \
 -b default -d file:///data/people.tsv --field-separator $_\t_ \
 -g key::%fname%::#UUID# -t 4</pre>
</div>
</div>
<div class="paragraph">
<p>To import data from /data/list.csv using a key containing the "name" column and
then a unique id separated by a # we could use the --generator-delimiter flag
to avoid escaping the # sign. An example would be:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbimport csv -c couchbase://127.0.0.1 -u Administrator -p password \
 -b default -d file:///data/list.csv --generator-delimiter '£' \
-g key::%name%#£UUID£ -t 4</pre>
</div>
</div>
<div class="paragraph">
<p>If the dataset in not available on the local machine where the command is run,
but is available via an HTTP URL we can still import the data using cbimport. If
we assume that the data is located at <a href="http://data.org/people.csv" class="bare">http://data.org/people.csv</a> then we can
import the data with the command below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbimport csv -c couchbase://127.0.0.1 -u Administrator -p password \
 -b default -d http://data.org/people.csv -g key::%fname%::#UUID# -t 4 \
 --http-cache-directory /tmp</pre>
</div>
</div>
<div class="paragraph">
<p>If the CSV dataset contains information which would allow importing into
scopes/collections then an command like the one below could be used.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>product, stock, type, subtype
apple, 100, produce, fruit</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cbimport csv -c couchbase://127.0.0.1 -u Administrator -p password
 -b default -d file://data/list.csv -g %product%
 --scope-collection-exp %type%.%subtype%</pre>
</div>
</div>
<div class="paragraph">
<p>This command would place the row into the fruit collection inside the
produce scope.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="discussion"><a class="anchor" href="#discussion"></a>DISCUSSION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The cbimport-csv command is used to quickly import data from various files
containing CSV, TSV or other separated format data. While importing CSV the
cbimport command only utilizes a single reader. As a result importing large
dataset may benefit from being partitioned into multiple files and running a
separate cbimport process on each file.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="environment-and-configuration-variables"><a class="anchor" href="#environment-and-configuration-variables"></a>ENVIRONMENT AND CONFIGURATION VARIABLES</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">CB_CLUSTER</dt>
<dd>
<p>Specifies the hostname of the Couchbase cluster to connect to. If the
hostname is supplied as a command line argument then this value is
overridden.</p>
</dd>
<dt class="hdlist1">CB_USERNAME</dt>
<dd>
<p>Specifies the username for authentication to a Couchbase cluster. If the
username is supplied as a command line argument then this value is
overridden.</p>
</dd>
<dt class="hdlist1">CB_PASSWORD</dt>
<dd>
<p>Specifies the password for authentication to a Couchbase cluster. If the
password is supplied as a command line argument then this value is
overridden.</p>
</dd>
<dt class="hdlist1">CB_CLIENT_CERT</dt>
<dd>
<p>The path to a client certificate used to authenticate when connecting to a
cluster. May be supplied with <code>CB_CLIENT_KEY</code> as an alternative to the
<code>CB_USERNAME</code> and <code>CB_PASSWORD</code> variables. See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a>
section for more information.</p>
</dd>
<dt class="hdlist1">CB_CLIENT_CERT_PASSWORD</dt>
<dd>
<p>The password for the certificate provided to the <code>CB_CLIENT_CERT</code> variable,
when using this variable, the certificate/key pair is expected to be in the
PKCS#12 format. See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a> section for more
information.</p>
</dd>
<dt class="hdlist1">CB_CLIENT_KEY</dt>
<dd>
<p>The path to the client private key whose public key is contained in the
certificate provided to the <code>CB_CLIENT_CERT</code> variable. May be supplied with
<code>CB_CLIENT_CERT</code> as an alternative to the <code>CB_USERNAME</code> and <code>CB_PASSWORD</code>
variables. See the <a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a> section for more information.</p>
</dd>
<dt class="hdlist1">CB_CLIENT_KEY_PASSWORD</dt>
<dd>
<p>The password for the key provided to the <code>CB_CLIENT_KEY</code> variable, when using
this variable, the key is expected to be in the PKCS#8 format.  See the
<a href="#CERTIFICATE_AUTHENTICATION">CERTIFICATE AUTHENTICATION (MTLS AUTHENTICATION)</a> section for more information.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>SEE ALSO</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="cbimport-json.html" class="xref page">cbimport-json</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cbimport"><a class="anchor" href="#cbimport"></a>CBIMPORT</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the <a href="cbimport.html" class="xref page">cbimport</a> suite</p>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2024 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Server","components":["server"],"url":"/home/server.html","latestVersions":{"server":"7.6"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab"></script>
<script defer src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
