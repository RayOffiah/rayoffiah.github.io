<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script>(window.dataLayer=window.dataLayer||[]).push({event:'gtm.js','gtm.start':+new Date()})</script>
<script async src="https://www.googletagmanager.com/gtm.js?id=GTM-MVPNN2"></script>
<title>Dynamic Attributes | Couchbase Docs</title>
<link rel="canonical" href="https://rayoffiah.github.io/DOC-9195/service-broker/current/concepts/dynamic-attributes.html">
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="service-broker">
<meta name="dcterms.identifier" content="1.1">
<meta name="page-url" content="/service-broker/current/concepts/dynamic-attributes.html">
<meta name="generator" content="Antora 3.0.1">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://rayoffiah.github.io/DOC-9195/home/index.html">
                    <img src="../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://rayoffiah.github.io/DOC-9195/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../cloud/index.html">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
<div class="components">
  <div class="components_group-title">
    Service Broker
  </div>
  <ul class="components_list">
    <li class="components_list-items">
      <div class="component_list-version">
        <span class="component_list_title">Service Broker</span>
        <select class="version_list" data-component="service-broker">
          <option value="1.1" data-url="../index.html" selected>1.1</option>
          <option value="1.0" data-url="../../1.0/index.html">1.0</option>
        </select>
      </div>
      <div class="version_items hide" data-version="1.1">
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../index.html">Service Broker Home</a>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../install/get-started.html">Getting Started</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../install/service-broker-example.html">Deploy Service Broker on Minikube</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="index.html">Concepts</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="architecture.html">Architecture</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="catalog.html">Service Catalog</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="bindings.html">Configuration Bindings</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="templates.html">Configuration Templates</a>
  </span>
</li>
<li class="menu_list is-current-page" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link is-current-page" href="dynamic-attributes.html">Dynamic Attributes</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="registry.html">Service Instance and Binding Registries</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="security.html">Security Models</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../tasks/index.html">Tasks</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../tasks/service-instance-url.html">Configure a Service Instance Dashboard URL</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../tasks/service-binding-credentials.html">Configure Service Binding Credentials</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../tasks/tls.html">Configure Service Instance TLS</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../reference/index.html">Reference</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../reference/servicebrokerconfigs.html">ServiceBrokerConfig Resource Reference</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../reference/template-functions.html">Dynamic Attribute Function Reference</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../reference/container.html">Service Broker Container Reference</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../reference/osb-api.html">Open Service Broker API Reference</a>
  </span>
</li>
<li class="menu_list is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Tools</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../reference/tools/cbsbctl.html">cbsbctl</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../release-notes.html">Release Notes</a>
  </span>
</li>
</ul>
</li>
</ul>
      </div>
      <div class="version_items hide" data-version="1.0">
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../../1.0/index.html">Service Broker Home</a>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../../1.0/install/get-started.html">Getting Started</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/install/service-broker-example.html">Deploy Service Broker on Minikube</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../../1.0/concepts/index.html">Concepts</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/concepts/architecture.html">Architecture</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/concepts/catalog.html">Service Catalog</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/concepts/bindings.html">Configuration Bindings</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/concepts/templates.html">Configuration Templates</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/concepts/dynamic-attributes.html">Dynamic Attributes</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/concepts/registry.html">Service Instance and Binding Registries</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/concepts/security.html">Security Models</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../../1.0/tasks/index.html">Tasks</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/tasks/service-instance-url.html">Configure a Service Instance Dashboard URL</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/tasks/service-binding-credentials.html">Configure Service Binding Credentials</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/tasks/tls.html">Configure Service Instance TLS</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../../1.0/reference/index.html">Reference</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/reference/servicebrokerconfigs.html">ServiceBrokerConfig Resource Reference</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/reference/template-functions.html">Dynamic Attribute Function Reference</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/reference/container.html">Service Broker Container Reference</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/reference/osb-api.html">Open Service Broker API Reference</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../../1.0/release-notes.html">Release Notes</a>
  </span>
</li>
</ul>
</li>
</ul>
      </div>
    </li>
  </ul>
</div>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="https://github.com/couchbase/docs-service-broker/edit/1.1.x/modules/ROOT/pages/concepts/dynamic-attributes.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../index.html">Service Broker</a></li>
<li class="crumb"><a href="../index.html">Service Broker Home</a></li>
<li class="crumb"><a href="index.html">Concepts</a></li>
<li class="crumb"><a href="dynamic-attributes.html">Dynamic Attributes</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Dynamic Attributes</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
This page describes how dynamic attributes in templates are processed by the Service Broker.
</blockquote>
</div>
<div class="paragraph">
<p>In the <a href="templates.html" class="xref page">last section</a> we described configuration templates and how they are used to generate valid Kubernetes resources.
In this section we will look in detail at dynamic attributes, how they work, what they can do and how they can make your service instances truly dynamic.</p>
</div>
<div class="paragraph">
<p>While this section focuses on dynamic attributes of resource templates, the same language syntax is used to process configuration binding registry definitions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dynamic-attributes"><a class="anchor" href="#dynamic-attributes"></a>Dynamic Attributes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dynamic attributes are best thought of as functions: they accept input arguments and return a single result.
Dynamic attributes do not have any side effects.</p>
</div>
<div class="paragraph">
<p>In general, dynamic attributes use the Go language <a href="https://golang.org/pkg/text/template/" target="_blank" rel="noopener">template</a> library with a few specializations.
Control flow is allowed, however, each dynamic attribute should execute at one action in order to generate a value.
Dot is not defined initially, all data must be accessed though accessor functions.
Iteration is not supported.</p>
</div>
<div class="sect2">
<h3 id="dynamic-attribute-typing"><a class="anchor" href="#dynamic-attribute-typing"></a>Dynamic Attribute Typing</h3>
<div class="paragraph">
<p>The key thing to note is that Go language templating operates on text.
Text has no concept of type (other than being a string) therefore all dynamic attributes must be serialized to JSON in order to preserve type information and allow the Service Broker to make the correct decisions.
The JSON serialization function is added implicitly, by the Service Broker, to all action pipelines that would usually generate template output.
All dynamic attributes are initially defined as strings, however the attribute itself takes on the type of the value returned by attribute template processing.</p>
</div>
<div class="sect3">
<h4 id="optional-attributes"><a class="anchor" href="#optional-attributes"></a>Optional Attributes</h4>
<div class="paragraph">
<p>All attribute templates are optional by default.
This supports such use cases where parameters supplied by the end user&#8212;&#8203;as defined by the <a href="catalog.html#json-schemas" class="xref page">service catalog schemas</a>--are optional.
If a user defined parameter is not specified, but referred to by an attribute template, the parameter argument lookup fails and the result will be internally set to <code>nil</code>.
If a configuration parameter value is <code>nil</code>, then the attribute is unset.</p>
</div>
<div class="paragraph">
<p>By exploiting optional parameters and how they are handled by the Service Broker, you can create basic conditional elements to your templates.</p>
</div>
</div>
<div class="sect3">
<h4 id="mandatory-attributes"><a class="anchor" href="#mandatory-attributes"></a>Mandatory Attributes</h4>
<div class="paragraph">
<p>As we have seen in our <a href="templates.html#template-example" class="xref page">earlier template example</a>, resource templates will not generate valid Kubernetes resources without certain attributes being populated.
This will manifest itself as a Kubernetes creation error, which may be difficult to debug.
You can catch these types of errors earlier, and with more context, by specifying that the parameter is required.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ parameter "/optional-parameter" | required }}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unlike optional parameters, required parameters will raise an error if the result resolves to <code>nil</code>.
This will indicate the error as related to the specific named parameter in the named template.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="service-broker-defined-functions"><a class="anchor" href="#service-broker-defined-functions"></a>Service Broker Defined Functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Service Broker defined functions are divided into categories based on their behavior.  These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Accessors&#8212;&#8203;these lookup data items.</p>
</li>
<li>
<p>Mutators&#8212;&#8203;these transform existing data items.</p>
</li>
<li>
<p>Generators&#8212;&#8203;these generate data items.</p>
</li>
<li>
<p>Assertions&#8212;&#8203;these perform error checking.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="accessors"><a class="anchor" href="#accessors"></a>Accessors</h3>
<div class="paragraph">
<p>Accessors do a simple lookup of a value from available data sources.</p>
</div>
<div class="sect3">
<h4 id="registry"><a class="anchor" href="#registry"></a>Registry</h4>
<div class="paragraph">
<p>The registry is described in detail in the next section.
It is a typed key/value store.
A registry source for name <code>foo</code> will return any value associated with the registry key <code>foo</code> as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ registry "fool" }}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="parameter"><a class="anchor" href="#parameter"></a>Parameter</h4>
<div class="paragraph">
<p>A parameter refers to a user specified parameter supplied with a create or update operation.
Parameters are a supplied as a free-form JSON object to the API.
The parameter function access to a string, number, array or object in the supplied JSON object.
Parameters are accessed with the <a href="https://tools.ietf.org/html/rfc6902" target="_blank" rel="noopener">JSON pointer</a> specification.
For example, given the parameters passed to the API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "size": 16,
  "resources": {
    "requests": {
      "cpu": "4",
      "memory": "16Gi"
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A dynamic attribute of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ parameter "/size" }}</code></pre>
</div>
</div>
<div class="paragraph">
<p>would resolve to <code>"4"</code>.</p>
</div>
<div class="paragraph">
<p>A dynamic attribute of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ parameter "/resources/requests" }}</code></pre>
</div>
</div>
<div class="paragraph">
<p>would resolve to <code>{"cpu":"4","memory":"16Gi"}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="template-snippet"><a class="anchor" href="#template-snippet"></a>Template Snippet</h4>
<div class="paragraph">
<p>The snippet function enables generation of complex results, and recursive template generation.
A specific example could involve Kubernetes label selectors.
Resources are labeled with a set of values, label selectors then filter resources based on the same labels.
In both cases the labels are the same, and can be generated by a common template snippet, rather than duplicated.
Template snippets are the one case where a configuration template need not generate a Kubernetes resource.</p>
</div>
<div class="paragraph">
<p>To demonstrate consider the following configuration template snippet definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">name: label-snippet
template:
  app: '{{ registry "my-app-name" }}' <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>app</code> attribute is dynamically set to the value defined by the <code>my-app-name</code> registry key.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Therefore if the registry key <code>my-app-name</code> contained the value <code>merlin</code>, then the snippet would generate the result <code>{"app":"merlin"}</code>.</p>
</div>
<div class="paragraph">
<p>To use the snippet, the following configuration template shows how:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">template:
  apiVersion: v1
  kind: Secret
  metadata:
    name: my-secret
    labels: '{{ snippet "label-snippet" }}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would generate the following Kubernetes resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: my-secret
  labels:
    app: merlin</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="template-array-snippet"><a class="anchor" href="#template-array-snippet"></a>Template Array Snippet</h4>
<div class="paragraph">
<p>The array snippet function acts like the snippet function, but extends it to iterate across an array of inputs and provide them as "dot" parameters to the snippet.
Array snippets return arrays of values, and provide a form of iteration.</p>
</div>
<div class="paragraph">
<p>For example, consider the following parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "ports": [
    {"name":"http","port":80},
    {"name":"https","port":443},
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can define a snippet to generate Kubernetes ports:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">name: port-snippet
template:
  name: {{ .name }}
  containerPort: {{ .port }}
  protocol: TCP</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then reference this snippet, and the parameter in your main pod template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">template:
  apiVersion: v1
  kind: Pod
  spec:
    containers:
    - ports: '{{ snippetArray "port-snippet" (parameter "ports" | required) }}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will yield the following rendered template:</p>
</div>
<div class="listingblock yaml">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">template:
  apiVersion: v1
  kind: Pod
  spec:
    containers:
    - ports:
      - name: http
        containerPort: 80
        protocol: TCP
      - name: https
        containerPort: 443
        protocol: TCP</code></pre>
</div>
</div>
<div class="paragraph">
<p>For further information on "dot" parameters, see the official Go language <a href="https://golang.org/pkg/text/template/#hdr-Arguments" target="_blank" rel="noopener">templating documentation</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mutators"><a class="anchor" href="#mutators"></a>Mutators</h3>
<div class="paragraph">
<p>Mutators allow data to be modified.</p>
</div>
<div class="sect3">
<h4 id="default"><a class="anchor" href="#default"></a>Default</h4>
<div class="paragraph">
<p>The default function allows a dynamic attribute to have a value set when an optional input argument is not specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ parameter "/size" | default 3 }}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="upper"><a class="anchor" href="#upper"></a>Upper</h4>
<div class="paragraph">
<p>The upper function upper cases a string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ upper "some string" }}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="lower"><a class="anchor" href="#lower"></a>Lower</h4>
<div class="paragraph">
<p>The lower function lower cases a string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ lower "some string" }}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="title"><a class="anchor" href="#title"></a>Title</h4>
<div class="paragraph">
<p>The upper function upper cases a string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ title "some string" }}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="generators"><a class="anchor" href="#generators"></a>Generators</h3>
<div class="paragraph">
<p>Generators create new values.
They may accept arguments that allow the generation functions to be dynamically configured.
Any cryptographic generators use cryptographically secure random number generators.</p>
</div>
<div class="sect3">
<h4 id="generate-password"><a class="anchor" href="#generate-password"></a>Generate Password</h4>
<div class="paragraph">
<p>The password generator generates ephemeral passwords of a specific length and results in a string.
The dictionary of characters used to generate passwords defaults to <code>[a-zA-Z0-9]</code>, however this can be explicitly defined.
To generate a 32 character password:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ generatePassword 32 nil }}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="generate-key"><a class="anchor" href="#generate-key"></a>Generate Key</h4>
<div class="paragraph">
<p>The key generator creates a private key and results in a string containing a PEM encoded private key.
Supported key types are RSA, ECDSA and ED25519.
Supported encoding types are PKCS#1, PKCS#8 and SEC 1.</p>
</div>
<div class="paragraph">
<p>For example, to generate a PKCS#8 encoded P256 elliptic curve private key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ generatePrivateKey "EllipticP256" "PKCS#8" nil }}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="generate-certificate"><a class="anchor" href="#generate-certificate"></a>Generate Certificate</h4>
<div class="paragraph">
<p>The certificate generator generates X.509 certificates and results in a string containing a PEM encoded certificate.
This generator optionally accepts a CA certificate and key pair with which to sign the resulting certificate.
If no CA is specified then the resulting certificate is self-signed.</p>
</div>
<div class="paragraph">
<p>The certificate generator supports CA, server and client certificate types.
Server and client certificates may be specified with DNS and e-mail subject alternative names respectively.</p>
</div>
<div class="paragraph">
<p>For example, to generate a signed X.509 certificate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ generateCertificate (registry "my-key") "My Certificate" "24h" "Server" (list "localhost") (registry "my-ca-key") (registry "my-ca-cert") }}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Recursive Template Processing</div>
<div class="paragraph">
<p>This example demonstrates the use of dynamic function arguments.
The private key associated with the certificate is provided as a PEM encoded string.
In this example we recursively lookup the certificate from the registry with <code>(registry "my-key")</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Automatic Certificate Rotation</div>
<div class="paragraph">
<p>The Service Broker is reactive&#8212;&#8203;it responds to API calls&#8212;&#8203;therefore will never support certificate rotation directly.
You should deploy a certificate manager with your service instances if this functionality is required by your security policy.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="assertions"><a class="anchor" href="#assertions"></a>Assertions</h3>
<div class="paragraph">
<p>Assertions allow error checking to be performed earlier in the pipeline to raise errors in a more constrained manner.</p>
</div>
<div class="sect3">
<h4 id="required"><a class="anchor" href="#required"></a>Required</h4>
<div class="paragraph">
<p>The required function will raise an error if the input argument is <code>nil</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">{{ parameter "/password" | required }}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="next-steps"><a class="anchor" href="#next-steps"></a>Next Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The final step to explain the Service Broker configuration is to look at the registry.
This is the last fundamental component of the Service Broker that must be understood in order to use and configure it effectively.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="registry.html" class="xref page">Service Instance and Binding Registries</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2022 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../../_/js/site.js"></script>
<script defer src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
