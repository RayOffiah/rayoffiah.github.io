<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="456px" preserveAspectRatio="none" style="width:582px;height:456px;background:#FFFFFF;" version="1.1" viewBox="0 0 582 456" width="582px" zoomAndPan="magnify"><defs><filter height="300%" id="f1cb1l4y09fsbf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" height="444.4" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.0;" width="425" x="151" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165" x="279" y="19">Couchbase Server Cluster</text><rect fill="#008080" filter="url(#f1cb1l4y09fsbf)" height="243.8001" style="stroke:#A80036;stroke-width:1.0;" width="10" x="214.5" y="112.6"/><rect fill="#00BFFF" filter="url(#f1cb1l4y09fsbf)" height="37" style="stroke:#A80036;stroke-width:1.0;" width="10" x="373.5" y="216"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="45" x2="45" y1="65.3999" y2="407.6001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="219" x2="219" y1="65.3999" y2="407.6001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="378" x2="378" y1="65.3999" y2="407.6001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="511" x2="511" y1="65.3999" y2="407.6001"/><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="56" x="15" y="29.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="22" y="50.6">Clients</text><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="56" x="15" y="406.6001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="22" y="427.6">Clients</text><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="101" x="169" y="25.6"/><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="101" x="165" y="29.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="172" y="50.6">Query Service</text><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="101" x="169" y="406.6001"/><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="101" x="165" y="410.6001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="172" y="431.6">Query Service</text><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="97" x="330" y="25.6"/><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="97" x="326" y="29.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="333" y="50.6">Index Service</text><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="97" x="330" y="406.6001"/><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="97" x="326" y="410.6001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="333" y="431.6">Index Service</text><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="93" x="465" y="25.6"/><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="93" x="461" y="29.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="468" y="50.6">Data Service</text><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="93" x="465" y="406.6001"/><rect fill="#FEFECE" filter="url(#f1cb1l4y09fsbf)" height="30.7999" rx="2.5" ry="2.5" style="stroke:#A80036;stroke-width:1.5;" width="93" x="461" y="410.6001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="468" y="431.6">Data Service</text><rect fill="#008080" filter="url(#f1cb1l4y09fsbf)" height="243.8001" style="stroke:#A80036;stroke-width:1.0;" width="10" x="214.5" y="112.6"/><rect fill="#00BFFF" filter="url(#f1cb1l4y09fsbf)" height="37" style="stroke:#A80036;stroke-width:1.0;" width="10" x="373.5" y="216"/><polygon fill="#A80036" points="202.5,108.6,212.5,112.6,202.5,116.6,206.5,112.6" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="45" x2="208.5" y1="112.6" y2="112.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="52" y="92.4">Submit the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="52" y="108">query</text><line style="stroke:#00000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="224.5" x2="266.5" y1="157.8" y2="157.8"/><line style="stroke:#00000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="266.5" x2="266.5" y1="157.8" y2="170.8"/><line style="stroke:#00000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="225.5" x2="266.5" y1="170.8" y2="170.8"/><polygon points="235.5,166.8,225.5,170.8,235.5,174.8,231.5,170.8" style="stroke:#00000000;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="231.5" y="137.6">Parse, analyze,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="231.5" y="153.2">create plan</text><polygon fill="#A80036" points="361.5,212,371.5,216,361.5,220,365.5,216" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="224.5" x2="367.5" y1="216" y2="216"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="231.5" y="195.8">Scan request; index</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="231.5" y="211.4">filters</text><polygon fill="#A80036" points="235.5,249,225.5,253,235.5,257,231.5,253" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="229.5" x2="377.5" y1="253" y2="253"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="246.5" y="267">Get qualified doc keys</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="288.5" y="282.6">and index keys</text><line style="stroke:#00000000;stroke-width:1.0;" x1="224.5" x2="266.5" y1="331.4001" y2="331.4001"/><line style="stroke:#00000000;stroke-width:1.0;" x1="266.5" x2="266.5" y1="331.4001" y2="344.4001"/><line style="stroke:#00000000;stroke-width:1.0;" x1="225.5" x2="266.5" y1="344.4001" y2="344.4001"/><polygon points="235.5,340.4001,225.5,344.4001,235.5,348.4001,231.5,344.4001" style="stroke:#00000000;stroke-width:1.0;fill:none;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="231.5" y="311.2001">Evaluate; documents</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="231.5" y="326.8001">to results</text><polygon fill="#A80036" points="56,352.4001,46,356.4001,56,360.4001,52,356.4001" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="50" x2="218.5" y1="356.4001" y2="356.4001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="178.5" y="370.4001">Query</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="181.5" y="386.0001">result</text><!--MD5=[22b18c73d4cc39956349b122a6caf851]
@startuml
skinparam maxMessageSize 125
skinparam roundcorner 5
skinparam responseMessageBelowArrow true
skinparam sequenceMessageAlign direction
skinparam ParticipantPadding 10
skinparam BoxPadding 60
skinparam box {
BackgroundColor PaleGreen
ArrowColor SeaGreen
BorderColor SpringGreen
}

participant Clients

box Couchbase Server Cluster #White
collections "Query Service" as Query
collections "Index Service" as Index
collections "Data Service" as Data
end box

Clients -> Query: Submit the\nquery
activate Query #teal

Query -[#transparent]-> Query: Parse, analyze, create plan

Query -> Index: Scan request; index filters
activate Index #deepskyblue
|||
Index -> Query: Get qualified doc keys and index keys
deactivate Index


Query -[#transparent]> Query: Evaluate; documents to results

Query -> Clients: Query\nresult
deactivate Query
@enduml

PlantUML version 1.2021.16(Wed Dec 08 17:25:22 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>