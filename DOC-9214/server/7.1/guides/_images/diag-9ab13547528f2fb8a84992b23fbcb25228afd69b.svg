<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="491px" preserveAspectRatio="none" style="width:508px;height:491px;background:#FFFFFF;" version="1.1" viewBox="0 0 508 491" width="508px" zoomAndPan="magnify"><defs><filter height="300%" id="fj1u5bl41jpqt" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fj1u5bl41jpqt)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="174" y="120.3999"/><rect fill="#FFFFFF" filter="url(#fj1u5bl41jpqt)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="312" y="150"/><rect fill="#FFFFFF" filter="url(#fj1u5bl41jpqt)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="312" y="293"/><rect fill="#FFFFFF" filter="url(#fj1u5bl41jpqt)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="455" y="322.6"/><rect fill="#FFFFFF" filter="url(#fj1u5bl41jpqt)" height="165.6001" style="stroke:#000000;stroke-width:2.0;" width="484" x="10" y="224.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="35" x2="35" y1="88.7999" y2="406.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="178.5" x2="178.5" y1="88.7999" y2="406.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="316.5" x2="316.5" y1="88.7999" y2="406.8001"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="460" x2="460" y1="88.7999" y2="406.8001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="20" y="85.9999">Dev</text><ellipse cx="35" cy="15" fill="#FEFECE" filter="url(#fj1u5bl41jpqt)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M35,23 L35,50 M22,31 L48,31 M35,50 L22,65 M35,50 L48,65 " fill="none" filter="url(#fj1u5bl41jpqt)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="24" x="20" y="419.8">Dev</text><ellipse cx="35" cy="432.6" fill="#FEFECE" filter="url(#fj1u5bl41jpqt)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M35,440.6 L35,467.6 M22,448.6 L48,448.6 M35,467.6 L22,482.6 M35,467.6 L48,482.6 " fill="none" filter="url(#fj1u5bl41jpqt)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fj1u5bl41jpqt)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="73" x="140.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="147.5" y="73.9999">JSEngine</text><rect fill="#FEFECE" filter="url(#fj1u5bl41jpqt)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="73" x="140.5" y="405.8001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="147.5" y="426.8">JSEngine</text><rect fill="#FEFECE" filter="url(#fj1u5bl41jpqt)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="95" x="267.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="274.5" y="73.9999">QueryEngine</text><rect fill="#FEFECE" filter="url(#fj1u5bl41jpqt)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="95" x="267.5" y="405.8001"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="274.5" y="426.8">QueryEngine</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="436" y="85.9999">Bucket</text><path d="M442,36 C442,26 460,26 460,26 C460,26 478,26 478,36 L478,62 C478,72 460,72 460,72 C460,72 442,72 442,62 L442,36 " fill="#FEFECE" filter="url(#fj1u5bl41jpqt)" style="stroke:#000000;stroke-width:1.5;"/><path d="M442,36 C442,46 460,46 460,46 C460,46 478,46 478,36 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="436" y="419.8">Bucket</text><path d="M442,432.6 C442,422.6 460,422.6 460,422.6 C460,422.6 478,422.6 478,432.6 L478,458.6 C478,468.6 460,468.6 460,468.6 C460,468.6 442,468.6 442,458.6 L442,432.6 " fill="#FEFECE" filter="url(#fj1u5bl41jpqt)" style="stroke:#000000;stroke-width:1.5;"/><path d="M442,432.6 C442,442.6 460,442.6 460,442.6 C460,442.6 478,442.6 478,432.6 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><rect fill="#FFFFFF" filter="url(#fj1u5bl41jpqt)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="174" y="120.3999"/><rect fill="#FFFFFF" filter="url(#fj1u5bl41jpqt)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="312" y="150"/><rect fill="#FFFFFF" filter="url(#fj1u5bl41jpqt)" height="88.8" style="stroke:#A80036;stroke-width:1.0;" width="10" x="312" y="293"/><rect fill="#FFFFFF" filter="url(#fj1u5bl41jpqt)" height="29.6" style="stroke:#A80036;stroke-width:1.0;" width="10" x="455" y="322.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="172" x2="162" y1="120.3999" y2="116.3999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="172" x2="162" y1="120.3999" y2="124.3999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="35" x2="173" y1="120.3999" y2="120.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="42" y="115.7999">JS: var q = select …</text><line style="stroke:#A80036;stroke-width:1.0;" x1="310" x2="300" y1="150" y2="146"/><line style="stroke:#A80036;stroke-width:1.0;" x1="310" x2="300" y1="150" y2="154"/><line style="stroke:#A80036;stroke-width:1.0;" x1="184" x2="311" y1="150" y2="150"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="191" y="145.4">N1QL(…) call</text><line style="stroke:#A80036;stroke-width:1.0;" x1="184" x2="194" y1="179.6" y2="175.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="184" x2="194" y1="179.6" y2="183.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="184" x2="316" y1="179.6" y2="179.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="201" y="175">return query</text><line style="stroke:#A80036;stroke-width:1.0;" x1="35" x2="45" y1="209.2" y2="205.2"/><line style="stroke:#A80036;stroke-width:1.0;" x1="35" x2="45" y1="209.2" y2="213.2"/><line style="stroke:#A80036;stroke-width:1.0;" x1="35" x2="178" y1="209.2" y2="209.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="52" y="204.6">return q</text><path d="M10,224.2 L83,224.2 L83,231.2 L73,241.2 L10,241.2 L10,224.2 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="165.6001" style="stroke:#000000;stroke-width:2.0;" width="484" x="10" y="224.2"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="25" y="238.2">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="117" x="98" y="237.1999">[Every document in q]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="177" x2="167" y1="263.4" y2="259.4"/><line style="stroke:#A80036;stroke-width:1.0;" x1="177" x2="167" y1="263.4" y2="267.4"/><line style="stroke:#A80036;stroke-width:1.0;" x1="35" x2="178" y1="263.4" y2="263.4"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="42" y="258.8">operate on document</text><line style="stroke:#A80036;stroke-width:1.0;" x1="310" x2="300" y1="293" y2="289"/><line style="stroke:#A80036;stroke-width:1.0;" x1="310" x2="300" y1="293" y2="297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179" x2="311" y1="293" y2="293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="186" y="288.4">get document</text><line style="stroke:#A80036;stroke-width:1.0;" x1="453" x2="443" y1="322.6" y2="318.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="453" x2="443" y1="322.6" y2="326.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="322" x2="454" y1="322.6" y2="322.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="329" y="318">get document</text><line style="stroke:#A80036;stroke-width:1.0;" x1="322" x2="332" y1="352.2001" y2="348.2001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="322" x2="332" y1="352.2001" y2="356.2001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="322" x2="459" y1="352.2001" y2="352.2001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="339" y="347.6">retrieved document</text><line style="stroke:#A80036;stroke-width:1.0;" x1="179" x2="189" y1="381.8001" y2="377.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179" x2="189" y1="381.8001" y2="385.8001"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179" x2="316" y1="381.8001" y2="381.8001"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="196" y="377.2001">retrieved document</text><!--MD5=[a2b264a9d3496d732a46326b81265bdf]
@startuml
actor Dev
 participant JSEngine
 participant QueryEngine
 database Bucket

 Dev ->> JSEngine: JS: var q = select …
 activate JSEngine
 JSEngine ->> QueryEngine : N1QL(…) call
 activate QueryEngine
 QueryEngine ->> JSEngine  : return query
 deactivate QueryEngine
 JSEngine ->> Dev : return q
 deactivate JSEngine

    loop Every document in q
      Dev ->> JSEngine   : operate on document
      JSEngine ->> QueryEngine ++ : get document
      QueryEngine ->> Bucket ++ : get document
      Bucket ->> QueryEngine - - : retrieved document
      QueryEngine ->> JSEngine - - : retrieved document
    end
@enduml

PlantUML version 1.2021.16(Wed Dec 08 17:25:22 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>